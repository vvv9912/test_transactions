# test_transactions
### Нужно реализовать систему транзакций. 
Как происходит транзакция:

Идет запрос на сервер от клиента, по клиенту выстраивается очередь на вывод.

Важно : 
1) у каждого клиента есть своя очередь; 
2) при нехватке денег, нужно блокировать запрос

Что нужно реализовать : 

- бд на postgresql, где будет схема с клиентами и их балансами

- сервер, которые проверяет все условия(хватает ли денег, если сервер упадет, то история, которая идет на вывод не должна пропасть) и делает изменение баланса(на + или -)
## Алгоритм работы
1. Сервер принимает запрос -> кладет в очередь -> отвечает клиенту. 

2. На сервере все время происходит обработка очереди и транзакций. 

3. На сервере есть еще одна ручка, для проверки клиентом, обработалась ли транзакция в очереди.

## Инструкция по использованию 
  - Собрать и запустить проект test_transactions
```sh
make build
make run
```
  - Доступные запросы:
```sh
- "{addr:port}/add?id={Номер айди}&money={Сколько пополнить}"
- "{addr:port}/sub?id={Номер айди}&money={Сколько списать}"
- "{addr:port}/check?id={Номер айди}"
```  
todo
Следует изменить логику в Producer: проверку условий вынести в запросы бд
